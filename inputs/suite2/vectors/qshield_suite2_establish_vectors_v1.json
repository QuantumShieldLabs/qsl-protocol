{
  "format": "QSHIELD-P4-VECTOR-SET-1",
  "schema_version": "1.0.0",
  "generated_at": "2025-12-31T00:00:00Z",
  "source": {
    "phase": "suite2",
    "artifact_id": "suite2-vectors",
    "member": "inputs/suite2/vectors/qshield_suite2_establish_vectors_v1.json",
    "format": "json",
    "version": "1.0.0"
  },
  "protocol": {
    "protocol_version": "0x0500",
    "suite_id": "0x0002",
    "suite_name": "QSP-SUITE-2"
  },
  "registries": {
    "reason_codes": [
      {
        "code": "REJECT_S2_ESTABLISH_BAD_MSG_TYPE",
        "description": "Establishment msg_type must be 0x01.",
        "spec_ref": "DOC-CAN-003 \u00a76.2"
      },
      {
        "code": "REJECT_S2_ESTABLISH_BAD_INPUT_LEN",
        "description": "Establishment input lengths are strict (session_id/dh_init/pq_init_ss/dh_self_pub/dh_peer_pub).",
        "spec_ref": "DOC-CAN-003 \u00a76.5"
      },
      {
        "code": "REJECT_S2_ESTABLISH_UNAUTHENTICATED",
        "description": "Base handshake outputs must be authenticated before Suite-2 state is committed.",
        "spec_ref": "DOC-CAN-003 \u00a76.3"
      },
      {
        "code": "REJECT_S2_LOCAL_UNSUPPORTED",
        "description": "Local policy does not allow Suite-2 establishment.",
        "spec_ref": "DOC-CAN-003 \u00a76.1"
      },
      {
        "code": "REJECT_S2_PEER_UNSUPPORTED",
        "description": "Peer capability does not support Suite-2 establishment.",
        "spec_ref": "DOC-CAN-003 \u00a76.1"
      },
      {
        "code": "REJECT_S2_SUITE_MISMATCH",
        "description": "Negotiated protocol_version/suite_id mismatch for Suite-2 establishment.",
        "spec_ref": "DOC-CAN-003 \u00a76.1"
      },
      {
        "code": "REJECT_S2_AD_MISMATCH",
        "description": "Negotiated protocol_version/suite_id must match bound values.",
        "spec_ref": "DOC-CAN-003 \u00a76.1"
      },
      {
        "code": "REJECT_S2_ESTABLISH_PQ_BIND_MISSING",
        "description": "Establishment missing PQ KEM public key/prekey binding.",
        "spec_ref": "DOC-CAN-003 \u00a76.6"
      },
      {
        "code": "REJECT_S2_ESTABLISH_PQ_BIND_MISMATCH",
        "description": "Establishment PQ KEM public key/prekey binding mismatch.",
        "spec_ref": "DOC-CAN-003 \u00a76.6"
      }
    ]
  },
  "vectors": [
    {
      "id": "S2-ESTABLISH-ACCEPT-0001",
      "op": "suite2.establish.run",
      "kind": "positive",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.1",
        "DOC-CAN-003 \u00a76.2",
        "DOC-CAN-003 \u00a76.3",
        "DOC-CAN-003 \u00a76.5",
        "DOC-CAN-003 \u00a78.2"
      ],
      "input": {
        "establish_a": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": true,
            "role": "A"
          }
        },
        "establish_b": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "authenticated": true,
            "role": "B"
          }
        },
        "message": {
          "type": "json",
          "data": {
            "plaintext_hex": {
              "type": "hex",
              "data": "01020304"
            },
            "flags": {
              "type": "json",
              "data": {
                "u16": 0
              }
            }
          }
        }
      },
      "expect": {
        "ok": true,
        "output": {
          "plaintext_hex": {
            "type": "hex",
            "data": "01020304"
          },
          "sender_ns": {
            "type": "json",
            "data": {
              "u32": 1
            }
          },
          "receiver_nr": {
            "type": "json",
            "data": {
              "u32": 1
            }
          }
        }
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-MSGTYPE-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.2",
        "DOC-SCL-002 \u00a775B"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 2,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": true,
            "role": "A"
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_ESTABLISH_BAD_MSG_TYPE"
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-BAD-LEN-SESSION-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.5",
        "DOC-SCL-002 \u00a775B"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": true,
            "role": "A"
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_ESTABLISH_BAD_INPUT_LEN"
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-BAD-LEN-DH-INIT-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.5",
        "DOC-SCL-002 \u00a775B"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": true,
            "role": "A"
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_ESTABLISH_BAD_INPUT_LEN"
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-BAD-LEN-PQ-INIT-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.5",
        "DOC-SCL-002 \u00a775B"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": true,
            "role": "A"
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_ESTABLISH_BAD_INPUT_LEN"
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-BAD-LEN-DH-SELF-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.5",
        "DOC-SCL-002 \u00a775B"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": true,
            "role": "A"
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_ESTABLISH_BAD_INPUT_LEN"
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-BAD-LEN-DH-PEER-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.5",
        "DOC-SCL-002 \u00a775B"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e"
            },
            "authenticated": true,
            "role": "A"
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_ESTABLISH_BAD_INPUT_LEN"
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-UNAUTH-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.3",
        "DOC-SCL-002 \u00a775B"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": false,
            "role": "A"
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_ESTABLISH_UNAUTHENTICATED"
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-LOCAL-UNSUPPORTED-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.1"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": true,
            "role": "A",
            "policy": {
              "local_supports_suite2": false
            }
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_LOCAL_UNSUPPORTED"
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-PEER-UNSUPPORTED-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.1"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": true,
            "role": "A",
            "policy": {
              "peer_support": "false"
            }
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_PEER_UNSUPPORTED"
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-SUITE-MISMATCH-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.1"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0403",
              "suite_id": "0x0001"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": true,
            "role": "A"
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_SUITE_MISMATCH"
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-PQ-BIND-MISSING-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.3",
        "DOC-CAN-003 \u00a76.6"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": true,
            "role": "A"
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_ESTABLISH_PQ_BIND_MISSING"
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-PQ-BIND-MISMATCH-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.3",
        "DOC-CAN-003 \u00a76.6"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 7
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": true,
            "role": "A"
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_ESTABLISH_PQ_BIND_MISMATCH"
      }
    },
    {
      "id": "S2-ESTABLISH-REJECT-AD-MISMATCH-0001",
      "op": "suite2.establish.run",
      "kind": "negative",
      "tags": [
        "CAT-S2-ESTABLISH-001",
        "G3",
        "G4"
      ],
      "spec_refs": [
        "DOC-CAN-003 \u00a76.1"
      ],
      "input": {
        "establish": {
          "type": "json",
          "data": {
            "msg_type": 1,
            "negotiated": {
              "protocol_version": "0x0500",
              "suite_id": "0x0002"
            },
            "bound": {
              "protocol_version": "0x0500",
              "suite_id": "0x0001",
              "pq_kem_pub_id": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",
              "pq_prekey_id": 42
            },
            "session_id": {
              "type": "hex",
              "data": "000102030405060708090a0b0c0d0e0f"
            },
            "dh_init": {
              "type": "hex",
              "data": "101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f"
            },
            "pq_init_ss": {
              "type": "hex",
              "data": "303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f"
            },
            "pq_kem_pub_id": {
              "type": "hex",
              "data": "a0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
            },
            "pq_prekey_id": {
              "type": "json",
              "data": {
                "u32": 42
              }
            },
            "dh_self_pub": {
              "type": "hex",
              "data": "505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f"
            },
            "dh_peer_pub": {
              "type": "hex",
              "data": "707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f"
            },
            "authenticated": true,
            "role": "A"
          }
        }
      },
      "expect": {
        "ok": false,
        "reason_code": "REJECT_S2_AD_MISMATCH"
      }
    }
  ]
}
